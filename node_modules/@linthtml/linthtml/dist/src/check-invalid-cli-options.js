import kebabCase from "lodash.kebabcase";
import chalk from "chalk";
import { EOL } from "os";
function buildAllowedOptions(allowedOptions) {
    let options = Object.keys(allowedOptions);
    options = options.reduce((opts, opt) => {
        const alias = allowedOptions[opt].alias;
        if (alias) {
            opts.push(alias);
        }
        return opts;
    }, options);
    options.sort();
    return options;
}
function cliOption(opt) {
    return opt.length === 1 ? `"-${opt}"` : `"--${kebabCase(opt)}"`;
}
function buildMessageLine(invalid) {
    return `Invalid option ${chalk.red(cliOption(invalid))}.${EOL}`;
}
export default function checkInvalidCLIOptions(allowedOptions, inputOptions) {
    const allOptions = buildAllowedOptions(allowedOptions);
    return Object.keys(inputOptions)
        .filter((opt) => !allOptions.includes(opt))
        .reduce((msg, invalid) => {
        return msg + buildMessageLine(invalid);
    }, "");
}
